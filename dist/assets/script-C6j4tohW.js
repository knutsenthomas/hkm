const E=document.getElementById("header"),S=document.getElementById("mobile-toggle"),b=document.getElementById("nav"),A=document.querySelectorAll(".nav-link");document.querySelector(".header-actions");function p(){if(window.innerWidth>1024)return;const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`);const t=document.querySelector(".hero-slider");t&&(t.style.height=`${window.innerHeight}px`)}document.addEventListener("DOMContentLoaded",()=>{setTimeout(p,100)});window.addEventListener("load",p);window.addEventListener("orientationchange",()=>{setTimeout(p,300)});let v=!1;window.addEventListener("scroll",()=>{v||(window.requestAnimationFrame(()=>{window.scrollY>100?E.classList.add("scrolled"):document.body.classList.contains("header-always-scrolled")||E.classList.remove("scrolled"),v=!1}),v=!0)},{passive:!0});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("header"),t=document.getElementById("menu-toggle"),n=document.getElementById("mega-menu"),s=document.body,i=t==null?void 0:t.querySelector(".open-icon"),o=t==null?void 0:t.querySelector(".close-icon");function r(){n&&e&&(n.classList.remove("invisible","opacity-0"),n.classList.add("visible","opacity-100"),e.classList.add("menu-open"),s.style.overflow="hidden",i==null||i.classList.add("hidden"),o==null||o.classList.remove("hidden"))}function a(){n&&e&&(n.classList.add("invisible","opacity-0"),n.classList.remove("visible","opacity-100"),e.classList.remove("menu-open"),s.style.overflow="",i==null||i.classList.remove("hidden"),o==null||o.classList.add("hidden"))}function c(){(n==null?void 0:n.classList.contains("opacity-100"))?a():r()}t&&t.addEventListener("click",c),document.addEventListener("keydown",l=>{l.key==="Escape"&&n&&n.classList.contains("opacity-100")&&a()})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".header-actions");if(e){let l=function(){o.classList.add("active"),document.body.style.overflow="hidden",r&&(r.value="",a.innerHTML='<p class="site-search-helper">Skriv inn et søkeord og trykk Enter.</p>',setTimeout(()=>r.focus(),50))},d=function(){o.classList.remove("active"),document.body.style.overflow=""};var t=l,n=d;const s=document.createElement("button");s.type="button",s.className="header-search-btn",s.innerHTML='<i class="fas fa-search"></i>';const i=e.firstElementChild;i?e.insertBefore(s,i):e.appendChild(s);const o=document.createElement("div");o.className="site-search-overlay",o.innerHTML=`
    <div class="site-search-dialog">
        <div class="site-search-header">
            <div class="site-search-input-wrapper">
                <i class="fas fa-search"></i>
                <input type="text" id="site-search-input" placeholder="Søk i innhold..." autocomplete="off" />
            </div>
            <button class="site-search-close" id="site-search-close" type="button" aria-label="Lukk søk">
                <span>&times;</span>
            </button>
        </div>
        <div class="site-search-results" id="site-search-results">
            <p class="site-search-helper">Skriv inn et søkeord og trykk Enter.</p>
        </div>
    </div>`,document.body.appendChild(o);const r=document.getElementById("site-search-input"),a=document.getElementById("site-search-results"),c=document.getElementById("site-search-close");s.addEventListener("click",l),c&&c.addEventListener("click",d),document.addEventListener("keydown",u=>{u.key==="Escape"&&o.classList.contains("active")&&d()}),o.addEventListener("click",u=>{u.target===o&&d()})}});class x{constructor(){this.slides=document.querySelectorAll(".hero-slide"),this.prevBtn=document.querySelector(".hero-nav.prev"),this.nextBtn=document.querySelector(".hero-nav.next"),this.slides.length!==0&&(this.currentIndex=0,this.interval=null,this.init())}init(){this.prevBtn&&this.prevBtn.addEventListener("click",()=>{this.stopAutoPlay(),this.prev(),this.startAutoPlay()}),this.nextBtn&&this.nextBtn.addEventListener("click",()=>{this.stopAutoPlay(),this.next(),this.startAutoPlay()}),this.startAutoPlay()}goTo(t){this.slides[this.currentIndex].classList.remove("active"),this.currentIndex=t,this.slides[this.currentIndex].classList.add("active")}next(){const t=(this.currentIndex+1)%this.slides.length;this.goTo(t)}prev(){const t=(this.currentIndex-1+this.slides.length)%this.slides.length;this.goTo(t)}startAutoPlay(){this.interval=setInterval(()=>this.next(),4e3)}stopAutoPlay(){this.interval&&clearInterval(this.interval)}}document.addEventListener("DOMContentLoaded",()=>{window.heroSlider=new x});document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){const n=this.getAttribute("href");if(n==="#"||n==="#gi-gave")return;t.preventDefault();const s=document.querySelector(n);if(s){const i=s.offsetTop-80;window.scrollTo({top:i,behavior:"smooth"})}})});let k=[];function g(){k=Array.from(document.querySelectorAll("section[id]")).map(e=>({id:e.id,top:e.offsetTop,height:e.clientHeight}))}window.addEventListener("load",g);window.addEventListener("resize",g);window.addEventListener("cmsContentLoaded",()=>{setTimeout(g,500)});let y=!1;window.addEventListener("scroll",()=>{y||(window.requestAnimationFrame(()=>{let e="";const t=window.scrollY;k.forEach(n=>{t>=n.top-200&&(e=n.id)}),A.forEach(n=>{var s;n.classList.remove("active"),e&&((s=n.getAttribute("href"))!=null&&s.includes(`#${e}`))&&n.classList.add("active")}),y=!1}),y=!0)},{passive:!0});class T{constructor(){this.counters=document.querySelectorAll(".funfact-number"),this.animated=!1,this.init()}init(){const t=new IntersectionObserver(s=>{s.forEach(i=>{i.isIntersecting&&!this.animated&&(this.animateCounters(),this.animated=!0)})},{threshold:.5}),n=document.querySelector(".funfacts");n&&t.observe(n)}animateCounters(){this.counters.forEach(t=>{const n=t.getAttribute("data-target"),s=parseInt(n)||0;if(s<=0){t.textContent=n&&!isNaN(parseInt(n))?n:"0",t.dataset.animated="true";return}const o=s/(2e3/16);let r=0;const a=()=>{r+=o,r<s?(t.textContent=Math.floor(r),requestAnimationFrame(a)):(t.textContent=s,t.dataset.animated="true")};a()})}}new T;function I(){const e=document.getElementById("yt-video-count"),t=document.getElementById("yt-view-count");if(!e&&!t)return;const r=`https://www.googleapis.com/youtube/v3/channels?part=statistics&id=UCFbX-Mf7NqDm2a07hk6hveg&key=${"AIzaSy"+"ClPHHywl7Vr0naj2JnK_t-lY-V86gmKys"}`;fetch(r).then(a=>a.json()).then(a=>{const c=a&&a.items&&a.items[0]&&a.items[0].statistics;if(!c)return;const l=Number(c.videoCount||0),d=Number(c.viewCount||0),u=(m,w)=>{m&&(m.setAttribute("data-target",String(w)),(m.dataset.animated==="true"||m.textContent==="NaN"||m.textContent==="0")&&(m.textContent=w))};u(e,l),u(t,d)}).catch(a=>{console.warn("Kunne ikke hente YouTube-statistikk:",a)})}function q(){const e=document.createElement("button");e.className="scroll-to-top",e.innerHTML='<i class="fas fa-chevron-up"></i>',e.setAttribute("aria-label","Til toppen"),document.body.appendChild(e);let t=!1;window.addEventListener("scroll",()=>{t||(window.requestAnimationFrame(()=>{window.scrollY>300?e.classList.add("visible"):e.classList.remove("visible"),t=!1}),t=!0)},{passive:!0}),e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}document.addEventListener("DOMContentLoaded",()=>{q(),I(),C()});function C(){const e=document.getElementById("podcast-episode-count");if(!e)return;fetch("https://getpodcast-42bhgdjkcq-uc.a.run.app").then(n=>n.json()).then(n=>{var r,a;const s=Array.isArray((r=n==null?void 0:n.rss)==null?void 0:r.channel)?n.rss.channel[0]:(a=n==null?void 0:n.rss)==null?void 0:a.channel,i=s==null?void 0:s.item;if(!i)return;const o=Array.isArray(i)?i.length:1;e.setAttribute("data-target",String(o)),(e.dataset.animated==="true"||e.textContent==="NaN"||e.textContent==="0")&&(e.textContent=o)}).catch(n=>{console.warn("Kunne ikke hente podcast-statistikk:",n)})}class B{constructor(){this.progressBars=document.querySelectorAll(".progress-fill"),this.animated=!1,this.init()}init(){const t=new IntersectionObserver(n=>{n.forEach(s=>{if(s.isIntersecting){const i=s.target,o=i.getAttribute("data-progress");i.style.width=o+"%"}})},{threshold:.5});this.progressBars.forEach(n=>t.observe(n))}}new B;class D{constructor(){this.testimonials=document.querySelectorAll(".testimonial-card"),this.currentTestimonial=0,this.testimonialInterval=null,this.testimonials.length>0&&this.init()}init(){this.setupNavigation(),this.startAutoPlay()}setupNavigation(){const t=document.querySelector(".testimonial-prev"),n=document.querySelector(".testimonial-next");t&&n&&(t.addEventListener("click",()=>this.prevTestimonial()),n.addEventListener("click",()=>this.nextTestimonial()))}goToTestimonial(t){this.testimonials[this.currentTestimonial].classList.remove("active"),this.currentTestimonial=t,this.testimonials[this.currentTestimonial].classList.add("active"),this.resetAutoPlay()}nextTestimonial(){const t=(this.currentTestimonial+1)%this.testimonials.length;this.goToTestimonial(t)}prevTestimonial(){const t=(this.currentTestimonial-1+this.testimonials.length)%this.testimonials.length;this.goToTestimonial(t)}startAutoPlay(){this.testimonialInterval=setInterval(()=>this.nextTestimonial(),6e3)}resetAutoPlay(){clearInterval(this.testimonialInterval),this.startAutoPlay()}}new D;const h=document.getElementById("newsletter-form");h&&h.addEventListener("submit",async e=>{e.preventDefault();const n=h.querySelector('input[type="email"]').value,s=h.querySelector('button[type="submit"]');try{s.disabled=!0,s.innerText="Sender...",window.firebaseService&&(await window.firebaseService.subscribeNewsletter(n),window.notifications?window.notifications.show(`Takk! Du er nå påmeldt med ${n}`,"success"):alert(`Takk for at du meldte deg på! Vi har sendt en bekreftelse til ${n}`),h.reset())}catch(i){console.error("Newsletter error:",i),window.notifications&&window.notifications.show("Det oppsto en feil. Prøv igjen senere.","error")}finally{s.disabled=!1,s.innerText="Abonner"}});const f=document.querySelector(".footer-newsletter");f&&f.addEventListener("submit",async e=>{e.preventDefault();const n=f.querySelector('input[type="email"]').value;try{window.firebaseService&&(await window.firebaseService.subscribeNewsletter(n),window.notifications?window.notifications.show("Takk for påmeldingen!","success"):alert(`Takk for at du meldte deg på! Vi har sendt en bekreftelse til ${n}`),f.reset())}catch(s){console.error("Newsletter error:",s)}});if("IntersectionObserver"in window){const e=new IntersectionObserver((t,n)=>{t.forEach(s=>{if(s.isIntersecting){const i=s.target;i.src=i.dataset.src||i.src,i.classList.add("loaded"),n.unobserve(i)}})});document.querySelectorAll("img[data-src]").forEach(t=>{e.observe(t)})}const M={threshold:.1,rootMargin:window.innerWidth<=768?"0px 0px -20px 0px":"0px 0px -100px 0px"},N=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(t.target.style.opacity="1",window.innerWidth<=768?t.target.style.transform="none":t.target.style.transform="translateY(0)")})},M);document.querySelectorAll(".feature-box, .cause-card, .event-card, .blog-card").forEach(e=>{window.innerWidth<=768?(e.style.opacity="1",e.style.transform="none",e.style.transition="none"):(e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",N.observe(e))});function P(){const e=document.querySelectorAll(".team-section .team-member");e.length&&e.forEach(t=>{const n=t.querySelector(".team-toggle"),s=t.querySelector(".team-name"),i=t.querySelector(".team-image"),o=()=>{const r=t.classList.toggle("expanded");n&&(n.textContent=r?"Vis mindre":"Les mer")};n&&n.addEventListener("click",r=>{r.preventDefault(),o()}),s&&(s.style.cursor="pointer",s.addEventListener("click",o)),i&&(i.style.cursor="pointer",i.addEventListener("click",o))})}const L=document.getElementById("year");L&&(L.textContent=new Date().getFullYear());document.querySelectorAll('a[href="#gi-gave"]').forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),alert("Takk for at du vil støtte vårt arbeid! Denne funksjonen vil kobles til et betalingssystem.")})});document.addEventListener("keydown",e=>{e.key==="Escape"&&b.classList.contains("active")&&(b.classList.remove("active"),S.classList.remove("active")),e.key==="ArrowLeft"?heroSlider.prevSlide():e.key==="ArrowRight"&&heroSlider.nextSlide()});window.addEventListener("load",()=>{const e=document.querySelectorAll(".slide");e.length!==0&&e.forEach((t,n)=>{var s;if(n>0){const i=t.querySelector(".slide-bg");if(i){const o=(s=i.style.backgroundImage.match(/url\(['"]?([^'"]+)['"]?\)/))==null?void 0:s[1];if(o){const r=new Image;r.src=o}}}})});function O(){const e=document.querySelectorAll(".amount-btn"),t=document.getElementById("custom-amount");e.length>0&&(e.forEach(s=>{s.addEventListener("click",i=>{i.preventDefault(),e.forEach(o=>{o.style.borderColor="#e0e0e0",o.style.background="white",o.style.color="inherit"}),s.style.borderColor="var(--primary-orange)",s.style.background="var(--primary-orange)",s.style.color="white",t&&(t.value=s.dataset.amount)})}),t&&t.addEventListener("input",()=>{e.forEach(s=>{s.style.borderColor="#e0e0e0",s.style.background="white",s.style.color="inherit"})}));const n=document.querySelectorAll('input[name="payment-method"]');n.length>0&&n.forEach(s=>{s.addEventListener("change",()=>{document.querySelectorAll('input[name="payment-method"]').forEach(i=>{i.parentElement.style.borderColor="#e0e0e0",i.parentElement.style.background="white"}),s.checked&&(s.parentElement.style.borderColor="var(--primary-orange)",s.parentElement.style.background="#fff5f2")})})}window.addEventListener("load",()=>{setTimeout(O,100)});function H(){const e=document.querySelector("[data-calendar-tabs]");if(!e)return;const t=e.querySelectorAll(".calendar-tab"),n=document.querySelectorAll(".calendar-frame");t.forEach(s=>{s.addEventListener("click",()=>{const i=s.getAttribute("data-calendar-view");t.forEach(o=>o.classList.remove("active")),s.classList.add("active"),n.forEach(o=>{const r=o.getAttribute("data-calendar-view");o.classList.toggle("active",r===i)})})})}function Y(){const e=document.querySelectorAll(".calendar-container");e.length&&e.forEach(t=>{const n=t.querySelectorAll(".cal-view-btn");if(!n.length)return;const s=t.querySelector(".calendar-grid"),i=t.querySelector(".calendar-agenda-card");if(!s||!i)return;const r=window.matchMedia("(max-width: 1024px)").matches?"agenda":"month";t.setAttribute("data-cal-view",r),n.forEach(a=>{const c=a.getAttribute("data-cal-view");a.classList.toggle("active",c===r),a.addEventListener("click",()=>{const l=a.getAttribute("data-cal-view");t.setAttribute("data-cal-view",l),n.forEach(d=>{d.classList.toggle("active",d===a)})})})})}function F(){const e=document.getElementById("copyright-year");e&&(e.textContent=new Date().getFullYear())}document.addEventListener("DOMContentLoaded",()=>{H(),Y(),P(),F()});window.addEventListener("load",()=>{document.body.classList.remove("cms-loading"),console.log("Public UI revealed (cms-loading removed)")});setTimeout(()=>{document.body.classList.remove("cms-loading")},2e3);
